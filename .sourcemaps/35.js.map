{"version":3,"sources":["../../src/pages/security/profile/modifier-profile/modifier-profile.module.ts","../../src/pages/security/profile/modifier-profile/modifier-profile.ts"],"names":[],"mappings":"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","file":"35.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\nimport { ModifierProfilePage } from './modifier-profile';\r\n//import { TranslationModule } from '../../../../translation/translate.module'\r\nimport { TranslateModule, TranslateLoader } from '@ngx-translate/core';\r\n\r\n@NgModule({\r\n  declarations: [ModifierProfilePage],\r\n  imports: [TranslateModule, IonicPageModule.forChild(ModifierProfilePage)],\r\n  exports: [ModifierProfilePage]\r\n})\r\nexport class ModifierProfilePageModule { }\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/security/profile/modifier-profile/modifier-profile.module.ts","import { Component } from '@angular/core';\nimport { NavController, NavParams, LoadingController, IonicPage, ToastController } from 'ionic-angular';\nimport { Validators, FormBuilder } from '@angular/forms';\nimport { PouchdbProvider } from '../../../../providers/pouchdb-provider';\n//import { ProfileUserPage } from '../../profile/profile-user';\nimport { TranslateService } from '@ngx-translate/core';\nimport { global } from '../../../../global-variables/variable';\nimport { Storage } from '@ionic/storage';\n\n/*\n  Generated class for the ModifierProfile page.\n\n  See http://ionicframework.com/docs/v2/components/#navigation for more info on\n  Ionic pages and navigation.\n*/\n@IonicPage()\n@Component({\n  selector: 'page-modifier-profile',\n  templateUrl: 'modifier-profile.html'\n})\nexport class ModifierProfilePage {\n  user: any;\n  registerForm: any;\n  l: any = global.langue;\n  motif: any;\n  nom: any = '';\n  prenom: any = '';\n  sex: any = ''\n\n  constructor(public translate: TranslateService, public navCtrl: NavController, public toastCtl: ToastController, public storage: Storage, public navParams: NavParams, public formBuilder: FormBuilder, public loadingCtl: LoadingController, public gestionService: PouchdbProvider) {\n    this.translate.setDefaultLang(global.langue);\n    this.user = this.navParams.data.user;\n    this.motif = this.navParams.data.motif;\n    this.nom = this.user.nom;\n    this.prenom = this.user.prenom;\n    this.sex = this.user.sex;\n\n    this.registerForm = this.formBuilder.group({\n        nom: [''],\n        name: [''],\n        prenom: [''],\n        //username: ['', Validators.required],\n        //email: [this.user.email],\n        mdpass: [''],\n        //confmdpass: ['', Validators.required],\n        //date: [this.user.date, Validators.required],\n        sex: ['', Validators.required],\n    })\n  }\n\n  afficheMsg(msg: string){\n    let toast = this.toastCtl.create({\n      message: msg,\n      position: 'top',\n      duration: 3000\n    });\n\n    toast.present();\n  }\n\n  ionViewWillEnter() {\n    this.translate.use(global.langue);\n    console.log('ionViewDidLoad ModifierProfilePage');\n  }\n\n  modifier(){\n    let newUserInfo = this.registerForm.value;\n    if(!this.motif){\n      this.gestionService.remoteSaved.putUser(this.user.name, {\n        metadata : {\n          prenom : newUserInfo.prenom,\n          date : newUserInfo.date,\n          sex : newUserInfo.sex,\n          nom: newUserInfo.nom\n        }\n      }, (err, response) => {\n        if(err){\n          alert('Erreur');\n        }else if(response){\n          this.gestionService.remoteSaved.getUser(this.user.name, (err, us) => {\n            if (!err) {\n              global.info_user = us;\n              this.storage.set('info_user', us);\n              this.afficheMsg('Profile mis à jour avec succès!')\n              this.navCtrl.pop();\n            }else{\n              this.afficheMsg('Profile mis à jour avec succès!')\n              this.navCtrl.pop();\n            }\n          });\n        }\n        \n      });\n\n    }else if(this.motif === 'cpwd'){\n      //chager le mot de passe\n\n      this.gestionService.remoteSaved.changePassword(this.user.name, newUserInfo.mdpass, (err, response) => {\n        if (err) {\n          if (err.name === 'not_found') {\n            // typo, or you don't have the privileges to see this user\n            alert('Privilège insuffisant');\n            //this.navCtrl.pop();\n          } else {\n            // some other error\n            alert('Une erreur est survenue')\n\n          }\n        } else {\n          global.info_connexion.mdpass = newUserInfo.mdpass;\n          this.storage.set('info_connexion', global.info_connexion);\n          alert('Mode de pass changé avec succès');\n          this.navCtrl.pop();\n          // response is the user update response\n          // {\n          //   \"ok\": true,\n          //   \"id\": \"org.couchdb.user:spiderman\",\n          //   \"rev\": \"2-09310a62dcc7eea42bf3d4f67e8ff8c4\"\n          // }\n        }\n      })\n\n    }else if(this.motif === 'cun'){\n      //changer le nom d'utilisateur\n      alert(this.user.name+' '+newUserInfo.name)\n       this.gestionService.remoteSaved.changeUsername(this.user.name, newUserInfo.name, (err) => {\n        if (err) {\n          if (err.name === 'not_found') {\n            // typo, or you don't have the privileges to see this user\n            alert('Privilège insuffisant');\n          } else if (err.taken) {\n            // auth error, make sure that 'batman' isn't already in DB\n            alert('Erreur, assurez vous que l\\'utilisateur existe dans la base!')\n          } else {\n            // some other error\n          }\n        } else {\n          this.user.name = newUserInfo.name;\n          global.info_user = this.user;\n          this.storage.set('info_user', global.info_user);\n          alert('Nom d\\'utilisateur changé avec succès');\n          this.navCtrl.pop();\n          // succeeded\n        }\n      })\n    }\n  }\n \n\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/security/profile/modifier-profile/modifier-profile.ts"],"sourceRoot":""}